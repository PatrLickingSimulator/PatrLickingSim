<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Patr Licking Simulator</title>
  <link rel="icon" type="image/png" href="favicon.png">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <style>
    * { font-family: 'Poppins', sans-serif; }
    body {
      text-align: center;
      padding: 30px;
      transition: background-color 0.5s, color 0.5s;
    }
    textarea {
      width: 80%;
      height: 100px;
      font-size: 16px;
      margin-bottom: 10px;
      border-radius: 8px;
      padding: 10px;
      border: 2px solid #ccc;
    }
    button {
      padding: 10px 20px;
      margin: 5px;
      font-size: 16px;
      cursor: pointer;
      border-radius: 6px;
      border: none;
      background-color: #ff6f00;
      color: white;
      font-weight: 600;
    }
    button:disabled {
      background-color: #aaa;
      cursor: not-allowed;
    }
    h2 {
      cursor: pointer;
      margin-top: 30px;
    }
    #points, #licksLeft {
      font-size: 20px;
      margin: 20px 0;
    }
    #message {
      margin-top: 15px;
      font-size: 18px;
    }
    #halloweenBanner {
      font-size: 32px;
      font-weight: 600;
      margin: 30px 0;
      color: #ff9800;
      text-shadow: 0 0 10px #ff9800;
      display: none;
    }
    .shop {
      margin: 20px 0;
    }
    .shop button {
      display: block;
      margin: 8px auto;
      width: 250px;
    }
    .footer {
      margin-top: 40px;
      font-size: 16px;
      opacity: 0.7;
    }
    .halloween {
      background-color: #1c1c1c;
      color: #ff9800;
    }
    .halloween button {
      background-color: #ff9800;
    }
    .halloween textarea {
      background-color: #2c2c2c;
      color: #ffcc80;
      border: 2px solid #ff9800;
    }
    .halloween h1 {
      text-shadow: 0 0 10px #ff9800;
    }
    .halloween #halloweenBanner {
      display: block;
    }
    .lore {
      margin-top: 40px;
      text-align: left;
      max-width: 700px;
      margin-left: auto;
      margin-right: auto;
    }
    .lore p {
      margin: 10px 0;
    }
  </style>
</head>
<body>
  <h1>üéÉ Patr Licking Simulator</h1>
  <div id="halloweenBanner">Happy Halloween üëª</div>
  <div id="points">Points: 0</div>
  <div id="licksLeft">Licks Available: 0</div>

  <textarea id="letterInput" placeholder="Write your spooky letter..."></textarea><br>
  <button onclick="writeLetter()">Submit Letter</button>
  <button onclick="lickLetter()" id="lickBtn" disabled>Lick Letter</button><br><br>

  <div class="shop">
    <h2 onclick="toggleShop('penShop')">üñã Pen Shop ‚ñº</h2>
    <div id="penShop" style="display: none;"></div>

    <h2 onclick="toggleShop('tongueShop')">üëÖ Tongue Shop ‚ñº</h2>
    <div id="tongueShop" style="display: none;"></div>
  </div>

  <div class="lore">
    <h2 onclick="toggleLore('origin')">üìñ Patr‚Äôs Origin ‚ñº</h2>
    <div id="origin" style="display:none;">
      <p>Long ago, in a forgotten mailbox deep in the woods, a mysterious figure named Patr was born from a cursed envelope. His tongue, enchanted by ancient ink, seeks only one thing: to taste the truth hidden in letters.</p>
      <p>Some say he was once a postman. Others believe he‚Äôs the ghost of a rejected love confession. All we know is‚Ä¶ he licks.</p>
    </div>

    <h2 onclick="toggleLore('shopkeeper')">üëª Haunted Shopkeeper ‚ñº</h2>
    <div id="shopkeeper" style="display:none;">
      <p>The Pen Shop is run by a shadowy figure known only as ‚ÄúThe Inkkeeper.‚Äù He never speaks ‚Äî except when you buy a Halloween pen. Then, he whispers things like ‚ÄúThis quill remembers your sins‚Äù or ‚ÄúThe pumpkin pen sees your future.‚Äù</p>
      <p>Some players report hearing scratching sounds after buying the Ghostwriter. Others‚Ä¶ never returned.</p>
    </div>
  </div>

  <div id="message"></div>
  <div class="footer">Made by Atharv & Arjun üî•</div>

  <script>
    const halloweenActive = new Date().getMonth() === 9 && new Date().getDate() < 32;

    const game = {
      points: 0,
      penLevel: 1,
      tongueLevel: 1,
      licksAvailable: 0,
      inventory: [],
      halloweenMode: halloweenActive,

      writeLetter(text) {
        const words = text.trim().split(/\s+/);
        const uniqueWords = new Set(words);
        const hasPunctuation = /[.!?]/.test(text);
        const isSpam = (() => {
          const repeatedWordSeq = /(\b\w+\b)(?:\s+\1){2,}/i.test(text);
          const lowWordVariety = uniqueWords.size < 5;
          const lowCharVariety = new Set(text.replace(/\s/g, '')).size < 5;
          const noRealWords = words.filter(w => w.length > 3).length < 2;
          return repeatedWordSeq || lowWordVariety || lowCharVariety || noRealWords;
        })();

        let base = uniqueWords.size * 5;
        if (hasPunctuation) base += 10;
        if (isSpam) base = Math.floor(base * 0.3);

        const bonus = base * this.penLevel;
        this.points += bonus;
        this.licksAvailable++;
        return { bonus, isSpam };
      },

      lickLetter() {
        if (this.licksAvailable <= 0) return 0;
        const bonus = 10 * this.tongueLevel;
        this.points += bonus;
        this.licksAvailable--;
        return bonus;
      },

      buyItem(type, item) {
        if (this.points < item.cost) return `‚ùå Not enough points for ${item.name}.`;
        if (this.inventory.includes(item.name)) return `‚ö†Ô∏è You already own ${item.name}.`;
        this.points -= item.cost;
        this.inventory.push(item.name);
        if (type === "pen") this.penLevel++;
        if (type === "tongue") this.tongueLevel++;
        let message = `‚úÖ Bought ${item.name}! ${type === "pen" ? "Pen" : "Tongue"} level is now ${type === "pen" ? this.penLevel : this.tongueLevel}.`;
        if (item.halloween) {
          message += ` üëª The haunted shopkeeper whispers: "${item.name} will change your fate..."`;
        }
        return message;
      }
    };

    if (game.halloweenMode) {
      document.body.classList.add("halloween");
    }

    const penItems = [
      { name: "Ballpoint Pen", cost: 100 },
      { name: "Gel Pen", cost: 200 },
      { name: "Fountain Pen", cost: 300 },
      { name: "Quill", cost: 400 },
      { name: "üéÉ Pumpkin Pen", cost: 250, halloween: true },
      { name: "üëª Ghostwriter", cost: 350, halloween: true },
      { name: "ü©∏ Bloody Quill", cost: 500, halloween: true }
    ];
    const tongueItems = [
      { name: "Normal Tongue", cost: 100 },
      { name: "Sticky Tongue", cost: 200 },
      { name: "Slurpy Tongue", cost: 300 },
      { name: "Turbo Tongue", cost: 400 },
      { name: "üßü Zombie Tongue", cost: 250, halloween: true },
      { name: "üëª Ghost Tongue", cost: 350, halloween: true },
      { name: "üßõ Vampire Tongue", cost: 500, halloween: true }
    ];

    function renderShop(shopId, items, type) {
      const container = document.getElementById(shopId);
      container.innerHTML = "";
      items.forEach(item => {
        if (item.halloween && !game.halloweenMode) return;
        const btn = document.createElement("button");
        btn.textContent = `${item.name} - ${item.cost} pts`;
        btn.onclick = () => updateUI(game.buyItem(type, item));
        container.appendChild(btn);
      });
    }

    function toggleShop(id) {
      const el = document.getElementById(id);
      el.style.display = el.style.display === "none" ? "block" : "none";
    }

    function toggleLore(id) {
      const el = document.getElementById(id);
      el.style.display = el.style.display === "none" ? "block" : "none";
    }

    function updateUI(message) {
      document.getElementById("points").textContent = `üßÆ Points: ${game.points}`;
      document.getElementById("licksLeft").textContent = `üëÖ Licks Available: ${game.licksAvailable}`;
      document.getElementById("message").textContent = message || "";
      document.getElementById("lickBtn").disabled = game.licksAvailable <= 0;
      renderShop("penShop", penItems, "pen");
      renderShop("tongueShop", tongueItems, "tongue");
    }

    function writeLetter() {
      const text = document.getElementById("letterInput").value;
      if (!text.trim()) return updateUI("‚úçÔ∏è Write something first!");
      const result = game.writeLetter(text);
      const spamNote = result.isSpam ? " ‚ö†Ô∏è Spam detected. Points reduced." : "";
      updateUI(`üìú Letter submitted! Earned ${result.bonus} points.${spamNote}`);
      document.getElementById("letterInput").value = "";
    }

    function lickLetter() {
      const earned = game.lickLetter();
      if (earned === 0) return updateUI("‚ùå No letters left to lick!");
      updateUI(`üëª Licked the letter! Earned ${earned} points.`);
    }
  </script>
</body>
</html>

