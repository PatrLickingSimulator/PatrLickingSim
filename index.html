<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Patr Licking Simulator ‚Äî Fusion</title>
  <link rel="icon" type="image/png" href="favicon.png">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --accent:#ff6f00;
      --accent-dark:#ff9800;
      --bg:#fffefc;
      --card:#fff8e1;
      --muted:#666;
      --panel-radius:14px;
      --glass: rgba(255,255,255,0.6);
    }
    *{box-sizing:border-box;font-family:"Poppins",system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;}
    html,body{height:100%;margin:0;}
    body{
      background: linear-gradient(180deg,#fffefa,#fff8e8);
      color:#222;
      display:flex;
      align-items:flex-start;
      justify-content:center;
      padding:36px;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      transition:background-color .4s,color .4s;
    }

    .container{
      width:100%;
      max-width:1100px;
      display:grid;
      gap:18px;
      grid-template-columns: 1fr 380px;
      align-items:start;
    }

    header{
      grid-column:1/-1;
      display:flex;
      align-items:center;
      gap:16px;
      justify-content:space-between;
    }
    header h1{
      margin:0;
      font-size:22px;
      letter-spacing:0.4px;
      display:flex;
      align-items:center;
      gap:12px;
    }
    header .sub{
      color:var(--muted);
      font-size:13px;
    }

    .main{
      background:var(--glass);
      border-radius:var(--panel-radius);
      padding:18px;
      box-shadow:0 8px 30px rgba(20,20,20,0.06);
      backdrop-filter: blur(6px);
      min-height:480px;
    }

    .stats-row{
      display:flex;
      gap:12px;
      align-items:center;
      justify-content:space-between;
      margin-bottom:14px;
    }

    .stat{
      background:linear-gradient(180deg,#fff,#fff8e1);
      padding:10px 14px;
      border-radius:10px;
      box-shadow:0 2px 8px rgba(0,0,0,0.04);
      min-width:120px;
      text-align:center;
      font-weight:600;
    }
    .big{
      font-size:20px;
    }

    #letterBox{
      background: #fff8f0;
      border:2px solid #f0d9b8;
      border-radius:10px;
      padding:12px;
      height:210px;
      overflow:auto;
      color:#333;
      margin-bottom:12px;
    }

    textarea#letterInput{
      width:100%;
      min-height:100px;
      max-height:220px;
      border-radius:10px;
      border:2px solid #efe1c9;
      padding:12px;
      font-size:15px;
      resize:vertical;
      outline:none;
    }

    .controls{
      display:flex;
      gap:10px;
      margin-top:10px;
    }

    button.btn{
      padding:10px 14px;
      border-radius:10px;
      border:none;
      cursor:pointer;
      font-weight:700;
      background:var(--accent);
      color:white;
      box-shadow:0 6px 14px rgba(255,111,0,0.18);
    }

    button.secondary{
      background:transparent;
      border:2px solid #ddd;
      color:#333;
      font-weight:600;
      box-shadow:none;
    }

    .msg{
      margin-top:10px;
      min-height:22px;
      color:#333;
      font-weight:600;
    }

    .side{
      background:var(--card);
      border-radius:var(--panel-radius);
      padding:16px;
      box-shadow:0 8px 30px rgba(20,20,20,0.05);
    }

    .shop-section h3{
      margin:6px 0 8px 0;
      font-size:16px;
      display:flex;
      justify-content:space-between;
      align-items:center;
    }

    .shop-list{
      display:grid;
      gap:8px;
      max-height:360px;
      overflow:auto;
      padding-right:6px;
    }

    .shop-item{
      display:flex;
      justify-content:space-between;
      align-items:center;
      padding:8px;
      background:linear-gradient(180deg,#fff,#fff3d9);
      border-radius:8px;
      border:1px solid rgba(0,0,0,0.03);
    }
    .shop-item small{display:block;color:#666;font-weight:600;font-size:12px;}
    .shop-item .buy{padding:6px 10px;border-radius:8px;background:var(--accent);color:#fff;border:none;cursor:pointer;font-weight:700;}

    .boxed-note{margin-top:12px;font-size:13px;color:#555;background:rgba(255,255,255,0.5);padding:8px;border-radius:8px;}

    footer{grid-column:1/-1;text-align:center;color:#666;margin-top:6px;font-size:13px;}

    .halloween{
      background:#121212 !important;
      color:var(--accent-dark) !important;
    }
    .halloween .main{background:#1c1c1c;}
    .halloween .side{background:#222;}
    .halloween textarea{background:#2b2b2b;color:#ffdca8;border-color:#ff9800;}
    .halloween .shop-item{background:#2a2a2a;color:#ffdca8;border-color:#ff9800;}
    .halloween button.btn{background:var(--accent-dark);box-shadow:none;}
    .halloween #halloweenBanner{display:block;}

    @media (max-width:980px){
      .container{grid-template-columns:1fr; padding-bottom:40px;}
      .side{order:2;}
    }
  </style>
</head>
<body>
  <div class="container" id="app">
    <header>
      <h1>üéÉ Patr / Patra Lekhan ‚Äî Licking Simulator <span style="font-size:13px;color:var(--muted);font-weight:600">Fusion Build</span></h1>
      <div class="sub">Made by Atharv & Arjun ‚Äî best simulator energy ‚öΩüî•</div>
    </header>

    <main class="main" id="main">
      <div class="stats-row">
        <div class="stat">
          <div style="font-size:12px;color:#666">üßÆ Points</div>
          <div id="points" class="big">0</div>
        </div>
        <div class="stat">
          <div style="font-size:12px;color:#666">üëÖ Licks Available</div>
          <div id="licksLeft" class="big">0</div>
        </div>
        <div style="min-width:170px;text-align:right">
          <div style="font-size:12px;color:#666">Bot</div>
          <div id="botName" style="font-weight:800">Patr-Bot</div>
        </div>
      </div>

      <div id="halloweenBanner" style="display:none;font-size:28px;font-weight:800;text-align:center;color:var(--accent-dark);margin-bottom:8px">Happy Halloween üëª</div>

      <div id="letterBox" aria-live="polite"><p style="margin:0;color:#666;"><em>Type your letter below and seal it to earn points. Keep it original ‚Äî copy-paste disabled.</em></p></div>

      <textarea id="letterInput" placeholder="Write your letter here..."></textarea>

      <div class="controls">
        <button class="btn" id="submitBtn">üìú Submit Letter</button>
        <button class="btn" id="sealBtn">üîí Seal Letter</button>
        <button class="btn" id="lickBtn">üòõ Lick / Quick-Lick</button>
        <button class="secondary" id="clearHistory">üßæ Clear History</button>
      </div>

      <div class="msg" id="message">Ready to write. Let's go!</div>
      <div class="boxed-note">Tip: Seal for judge-based points. Lick for immediate bonus. Rapid-click the lick button for quick-lick combos!</div>
    </main>

    <aside class="side">
      <div class="shop-section">
        <h3>üñã Pen Shop <small style="font-weight:600;color:#666"> (Boost writing power)</small></h3>
        <div id="penShop" class="shop-list"></div>
      </div>

      <div class="shop-section" style="margin-top:12px">
        <h3>üëÖ Tongue Shop <small style="font-weight:600;color:#666"> (Boost licking power)</small></h3>
        <div id="tongueShop" class="shop-list"></div>
      </div>

      <div style="margin-top:12px">
        <div style="font-weight:700;margin-bottom:6px">Inventory</div>
        <div id="inventory" style="min-height:40px;color:#444">‚Äî none ‚Äî</div>
      </div>

      <div style="margin-top:12px;font-size:13px;color:#444">
        <strong>Controls</strong>
        <ul style="padding-left:18px;margin:8px 0 0 0;color:#444">
          <li>Submit ‚Äî evaluates & gives points + licks</li>
          <li>Seal ‚Äî judge length-based bonus and archives letter</li>
          <li>Lick ‚Äî consumes a stored lick for big bonus. Rapid clicks give combo points.</li>
        </ul>
      </div>
    </aside>

    <footer>Made with üî• by Atharv & Arjun ‚Äî fusion edition</footer>
  </div>

  <!-- Audio -->
  <audio id="penSound" src="https://www.soundjay.com/mechanical/pen-scratch-1.mp3" preload="auto"></audio>
  <audio id="sealSound" src="https://www.soundjay.com/button/button-16.mp3" preload="auto"></audio>
  <audio id="lickSound" src="https://www.soundjay.com/button/button-10.mp3" preload="auto"></audio>

  <script>
    // ---------- Game state ----------
    const halloweenActive = new Date().getMonth() === 9 && new Date().getDate() < 32;
    const game = {
      points: 0,
      penLevel: 1,
      tongueLevel: 1,
      licksAvailable: 0,
      inventory: [],
      halloweenMode: halloweenActive
    };

    // ---------- Load from localStorage ----------
    function loadGame(){
      const saved = localStorage.getItem("patrSimSave");
      if(saved){
        const data = JSON.parse(saved);
        Object.assign(game, data);
      }
    }

    function saveGame(){
      localStorage.setItem("patrSimSave", JSON.stringify(game));
    }

    loadGame();

    // ---------- Items ----------
    const penItems = [
      { name: "Ballpoint Pen", cost: 100, stats: { power: 5, speed: 5, rarity: "Common" }, description: "Reliable, boring, but better than nothing." },
      { name: "Gel Pen", cost: 200, stats: { power: 10, speed: 8, rarity: "Common" }, description: "Smooth and fast." },
      { name: "Fountain Pen", cost: 300, stats: { power: 15, speed: 10, rarity: "Rare" }, description: "Elegant ink flow." },
      { name: "Quill", cost: 400, stats: { power: 18, speed: 12, rarity: "Rare" }, description: "Classic and poetic." },
      { name: "üß† Brainstem Pen", cost: 500, stats: { power: 20, speed: 15, rarity: "Epic" }, description: "Licks with intelligence." },
      { name: "ü™û Mirror Pen", cost: 1500, stats: { power: 48, speed: 30, rarity: "Epic" }, description: "Reflects your intent. Doubles poetic letters." },
      { name: "üßø Evil Eye Ink", cost: 1600, stats: { power: 50, speed: 32, rarity: "Legendary" }, description: "Protects from spam. Bonus on cursed letters." },
      { name: "ü™ê Void Marker", cost: 2000, stats: { power: 60, speed: 45, rarity: "Legendary" }, description: "Letters vanish to infinity. Points multiplied." },
    ];

    const tongueItems = [
      { name: "Basic Tongue", cost: 100, stats: { lick: 1 }, description: "Normal lick." },
      { name: "Long Tongue", cost: 250, stats: { lick: 2 }, description: "Larger reach, stronger lick." },
      { name: "Sticky Tongue", cost: 400, stats: { lick: 3 }, description: "Extra adhesion for bonus points." },
      { name: "Dragon Tongue", cost: 1000, stats: { lick: 7 }, description: "Fires rapid licks, big power." },
      { name: "Golden Tongue", cost: 1500, stats: { lick: 12 }, description: "Legendary licking power." }
    ];

    // ---------- Shop ----------
    function renderShop(){
      const penShop = document.getElementById("penShop");
      penShop.innerHTML = "";
      penItems.forEach((item,i)=>{
        const div = document.createElement("div");
        div.className="shop-item";
        div.innerHTML=`<div>
          <strong>${item.name}</strong>
          <small>${item.description}</small>
        </div>
        <div>
          <div style="font-size:13px;color:#333;font-weight:700">‚Çπ${item.cost}</div>
          <button class="buy" onclick="buyPen(${i})">Buy</button>
        </div>`;
        penShop.appendChild(div);
      });

      const tongueShop = document.getElementById("tongueShop");
      tongueShop.innerHTML = "";
      tongueItems.forEach((item,i)=>{
        const div = document.createElement("div");
        div.className="shop-item";
        div.innerHTML=`<div>
          <strong>${item.name}</strong>
          <small>${item.description}</small>
        </div>
        <div>
          <div style="font-size:13px;color:#333;font-weight:700">‚Çπ${item.cost}</div>
          <button class="buy" onclick="buyTongue(${i})">Buy</button>
        </div>`;
        tongueShop.appendChild(div);
      });
    }

    function buyPen(index){
      const item = penItems[index];
      if(game.points >= item.cost){
        game.points -= item.cost;
        game.penLevel = item.stats.power;
        game.inventory.push(item.name);
        updateStats();
        renderInventory();
        saveGame();
        showMsg(`Bought ${item.name}! Writing power upgraded.`);
      }else showMsg("Not enough points for this pen.");
    }

    function buyTongue(index){
      const item = tongueItems[index];
      if(game.points >= item.cost){
        game.points -= item.cost;
        game.tongueLevel = item.stats.lick;
        game.inventory.push(item.name);
        updateStats();
        renderInventory();
        saveGame();
        showMsg(`Bought ${item.name}! Licking power upgraded.`);
      }else showMsg("Not enough points for this tongue.");
    }

    function renderInventory(){
      const inv = document.getElementById("inventory");
      inv.innerHTML = game.inventory.length ? game.inventory.join(" | ") : "‚Äî none ‚Äî";
    }

    // ---------- Stats ----------
    function updateStats(){
      document.getElementById("points").textContent = game.points;
      document.getElementById("licksLeft").textContent = game.licksAvailable;
    }

    function showMsg(msg){
      const el = document.getElementById("message");
      el.textContent = msg;
    }

    // ---------- Actions ----------
    const letterInput = document.getElementById("letterInput");
    const letterBox = document.getElementById("letterBox");
    document.getElementById("submitBtn").addEventListener("click", submitLetter);
    document.getElementById("sealBtn").addEventListener("click", sealLetter);
    document.getElementById("lickBtn").addEventListener("click", lickLetter);
    document.getElementById("clearHistory").addEventListener("click", ()=>{
      letterBox.innerHTML = "";
      showMsg("Letter history cleared.");
      saveGame();
    });

    function submitLetter(){
      const text = letterInput.value.trim();
      if(!text){ showMsg("Type something first!"); return; }

      // Prevent copy-paste spam
      if(window.getSelection().toString().length > 0){
        showMsg("No copy-paste allowed!");
        return;
      }

      const pointsEarned = Math.min(text.length, 100) + game.penLevel;
      const licksGained = Math.ceil(pointsEarned/25);
      game.points += pointsEarned;
      game.licksAvailable += licksGained;
      letterBox.innerHTML += `<p>‚úçÔ∏è Letter submitted (+${pointsEarned} points, +${licksGained} licks)</p>`;
      letterInput.value = "";
      document.getElementById("penSound").play();
      updateStats();
      saveGame();
    }

    function sealLetter(){
      const text = letterInput.value.trim();
      if(!text){ showMsg("Nothing to seal!"); return; }
      const bonus = Math.floor(text.length/2) + game.penLevel;
      game.points += bonus;
      game.licksAvailable += Math.floor(bonus/10);
      letterBox.innerHTML += `<p>üîí Letter sealed (+${bonus} bonus points)</p>`;
      letterInput.value = "";
      document.getElementById("sealSound").play();
      updateStats();
      saveGame();
    }

    function lickLetter(){
      if(game.licksAvailable <=0){ showMsg("No licks available! Submit letters to gain licks."); return; }
      const lickPoints = Math.floor(game.tongueLevel*5 + Math.random()*5);
      game.points += lickPoints;
      game.licksAvailable--;
      letterBox.innerHTML += `<p>üòõ Lick used! +${lickPoints} points</p>`;
      document.getElementById("lickSound").play();
      updateStats();
      saveGame();
    }

    // ---------- Keyboard shortcut ----------
    letterInput.addEventListener("keydown",e=>{
      if(e.ctrlKey && e.key==="Enter"){ submitLetter(); }
    });

    // ---------- Init ----------
    if(game.halloweenMode){
      document.body.classList.add("halloween");
    }
    renderShop();
    renderInventory();
    updateStats();
    showMsg("Game loaded. Ready to write and lick!");
  </script>
</body>
</html>
